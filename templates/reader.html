{# Reader Page - Aggregated posts from blogroll feeds #}
{% extends "base.html" %}

{% block title %}{{ title | default:"Reader" }}{% if page.number > 1 %} - Page {{ page.number }}{% endif %} - {{ config.title | default:"My Site" }}{% endblock %}
{% block description %}{{ description | default:"Latest posts from blogs I follow" }}{% endblock %}

{% block body_class %}page-reader{% endblock %}

{% block htmx %}
{% if page.pagination_type == "htmx" or page.pagination_type == "htmx-infinite" %}
<script src="{% if config.Extra.asset_urls.htmx %}{{ config.Extra.asset_urls.htmx }}{% else %}https://unpkg.com/htmx.org@1.9.10{% endif %}"></script>
{% if page.pagination_type == "htmx-infinite" %}
<script src="{{ 'js/infinite-scroll.js' | theme_asset }}" defer></script>
{% endif %}
{% elif page.pagination_type == "js" %}
<script src="{{ 'js/pagination.js' | theme_asset }}" defer></script>
{% endif %}
{% endblock %}

{% block content %}
<div class="reader-page">
  <header class="reader-header">
    <h1>{{ title | default:"Reader" }}</h1>
    <p class="reader-subtitle">{{ description | default:"Latest posts from blogs I follow" }}</p>
  </header>

  <nav class="reader-nav" aria-label="Page navigation">
    <a href="/blogroll/">View Blogroll</a>
  </nav>

  <ul class="reader-entries posts-list">
    {% for entry in entries %}
    <li class="reader-entry">
      <article>
        {% if entry.image_url %}
        <img src="{{ entry.image_url }}" alt="" class="entry-image" loading="lazy">
        {% endif %}
        <h2 class="reader-entry-title">
          <a href="{{ entry.url }}" target="_blank" rel="noopener">{{ entry.title }}</a>
        </h2>
        <div class="reader-entry-meta">
          <span class="reader-entry-source">{{ entry.feed_title }}</span>
          {% if entry.published %}
          <time datetime="{{ entry.published | atom_date }}">{{ entry.published | date:"Jan 2, 2006" }}</time>
          {% endif %}
        </div>
        {% if entry.description %}
        <p class="reader-entry-description">{{ entry.description | striptags | truncatewords:40 }}</p>
        {% endif %}
      </article>
    </li>
    {% endfor %}
  </ul>

  {% include "partials/pagination.html" %}
</div>
{% endblock %}
