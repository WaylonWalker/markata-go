{# Post-specific h-card (Microformats2) #}
{# This provides IndieWeb-friendly per-post author markup #}
{# Supports both multi-author and single author configurations #}

{% if post.authors and authors %}
{# Multi-author post - show individual author h-cards #}
<div class="post-authors">
  {% for author_id in post.authors %}
    {% set author = authors[author_id] %}
    <div class="author h-card">
      {% if author.avatar %}
      <img class="u-photo" src="{{ author.avatar }}" alt="{{ author.name }}" width="44" height="44" loading="lazy">
      {% endif %}

      <div class="author-info">
        <a class="p-name u-url" href="/authors/{{ author_id }}/">{{ author.name }}</a>

        {% if author.bio %}
        <span class="p-note">{{ author.bio }}</span>
        {% endif %}

        {% if author.role or author.contributions or author.contribution %}
        <span class="author-role">{{ author.role_display }}</span>
        {% endif %}

        {% if author.guest %}
        <span class="author-badge">Guest</span>
        {% endif %}
      </div>
    </div>
  {% endfor %}
</div>
{% elif config.author or config.title %}
{# Backward compatibility: Single site author #}
{# Use CSS-based hiding instead of HTML `hidden` so mf2 parsers can discover u-photo. #}
<div class="h-card site-author-card visually-hidden">
    {# Author/site name #}
    {% if config.author %}
    <span class="p-name">{{ config.author }}</span>
    {% elif config.title %}
    <span class="p-name">{{ config.title }}</span>
    {% endif %}

    {# Canonical site URL #}
    {% if config.url %}
    <a class="u-url u-uid" href="{{ config.url }}">{{ config.url }}</a>
    {% endif %}

    {# Author avatar/photo from SEO config #}
    {% if config.seo.author_image %}
    <img class="u-photo" src="{% if config.seo.author_image | startswith:'http' %}{{ config.seo.author_image }}{% else %}{{ config.url }}{{ config.seo.author_image }}{% endif %}" alt="{{ config.author | default:config.title }} avatar" width="44" height="44" loading="lazy">
    {% elif config.seo.default_image %}
    <img class="u-photo" src="{% if config.seo.default_image | startswith:'http' %}{{ config.seo.default_image }}{% else %}{{ config.url }}{{ config.seo.default_image }}{% endif %}" alt="{{ config.author | default:config.title }} avatar" width="44" height="44" loading="lazy">
    {% endif %}

    {# Optional note/bio if available #}
    {% if config.description %}
    <span class="p-note">{{ config.description }}</span>
    {% endif %}
</div>
{% endif %}
