<!DOCTYPE html>
<html lang="{{ config.lang | default:'en' }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  {% block meta %}
  <title>{% block title %}{{ config.title | default:'My Site' }}{% endblock %}</title>
  <meta name="description" content="{% block description %}{{ config.description | default:'' }}{% endblock %}">
  {% endblock %}
  
  {% block head %}
  <!-- Theme CSS -->
  <link rel="stylesheet" href="{{ 'css/variables.css' | theme_asset }}">
  <link rel="stylesheet" href="{{ 'css/main.css' | theme_asset }}">
  <link rel="stylesheet" href="{{ 'css/admonitions.css' | theme_asset }}">
  <link rel="stylesheet" href="{{ 'css/code.css' | theme_asset }}">
  
  <!-- CSS variable overrides from theme config -->
  {% if config.theme.variables %}
  <style>:root { {% for k, v in config.theme.variables.items() %}{{ k }}: {{ v }}; {% endfor %} }</style>
  {% endif %}
  
  <!-- Style config overrides (per HEAD_STYLE.md spec) -->
  {% if config.style %}
  <style>
    :root {
      {% if config.style.color_bg %}--color-background: {{ config.style.color_bg }};{% endif %}
      {% if config.style.color_text %}--color-text: {{ config.style.color_text }};{% endif %}
      {% if config.style.color_link %}--color-primary: {{ config.style.color_link }};{% endif %}
      {% if config.style.color_accent %}--color-primary-dark: {{ config.style.color_accent }};{% endif %}
      {% if config.style.body_width %}--content-width: {{ config.style.body_width }};{% endif %}
    }
    @media (prefers-color-scheme: light) {
      :root {
        {% if config.style.color_bg_light %}--color-background: {{ config.style.color_bg_light }};{% endif %}
        {% if config.style.color_text_light %}--color-text: {{ config.style.color_text_light }};{% endif %}
        {% if config.style.color_link_light %}--color-primary: {{ config.style.color_link_light }};{% endif %}
        {% if config.style.color_accent_light %}--color-primary-dark: {{ config.style.color_accent_light }};{% endif %}
      }
    }
  </style>
  {% endif %}
  
  <!-- Custom CSS file -->
  {% if config.theme.custom_css %}
  <link rel="stylesheet" href="{{ config.theme.custom_css | asset_url }}">
  {% endif %}
  
  <!-- RSS/Atom Feeds -->
  <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="/rss.xml">
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml">
  
  <!-- Global head config (per HEAD_STYLE.md spec) -->
  {% if config.head %}
    <!-- Raw text/HTML -->
    {% if config.head.text %}{{ config.head.text | safe }}{% endif %}
    
    <!-- Meta tags -->
    {% for meta in config.head.meta %}
      {% if meta.name %}
      <meta name="{{ meta.name }}" content="{{ meta.content }}">
      {% elif meta.property %}
      <meta property="{{ meta.property }}" content="{{ meta.content }}">
      {% endif %}
    {% endfor %}
    
    <!-- Link tags -->
    {% for link in config.head.link %}
    <link rel="{{ link.rel }}" href="{{ link.href }}"{% if link.crossorigin %} crossorigin{% endif %}>
    {% endfor %}
    
    <!-- Script tags -->
    {% for script in config.head.script %}
    <script src="{{ script.src }}"></script>
    {% endfor %}
  {% endif %}
  {% endblock %}
</head>
<body>
  {% block header %}
  {% include "partials/header.html" %}
  {% endblock %}
  
  <main>
    {% block content %}{% endblock %}
  </main>
  
  {% block footer %}
  {% include "partials/footer.html" %}
  {% endblock %}
  
  {% block htmx %}{% endblock %}
  {% block scripts %}{% endblock %}
</body>
</html>
