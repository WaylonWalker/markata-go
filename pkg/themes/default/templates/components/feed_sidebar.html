{# Feed sidebar component template #}
{# Usage: {% include "components/feed_sidebar.html" %} #}
{# Shows navigation links for posts in the same feed/series #}
{# Requires: config.components.feed_sidebar (FeedSidebarConfig) #}
{# Optional: sidebar_posts, sidebar_feed - injected by templates plugin for post pages #}

{% with sidebar = config.components.feed_sidebar %}
{# Only show sidebar if enabled AND we have posts to display #}
{# sidebar_posts is injected when the current post belongs to a configured feed #}
{% if sidebar.enabled and (sidebar_posts or feed.posts or posts) %}
<aside class="feed-sidebar feed-sidebar--{{ sidebar.position | default:'left' }}" style="width: {{ sidebar.width | default:'250px' }}" aria-label="Feed navigation">
    <nav class="feed-nav">
        {% if sidebar.title %}
        <h2 class="feed-nav-title">{{ sidebar.title }}</h2>
        {% elif sidebar_feed.title %}
        <h2 class="feed-nav-title">{{ sidebar_feed.title }}</h2>
        {% elif feed.title %}
        <h2 class="feed-nav-title">{{ feed.title }}</h2>
        {% else %}
        <h2 class="feed-nav-title">In this series</h2>
        {% endif %}

        {# Priority: sidebar_posts (injected for post pages) > feed.posts (feed pages) > posts (generic) #}
        {% if sidebar_posts %}
        <ul class="feed-nav-list">
            {% for p in sidebar_posts %}
            <li class="feed-nav-item{% if post.slug == p.slug %} feed-nav-item--active{% endif %}">
                <a href="{{ p.href }}" class="feed-nav-link">
                    {{ p.title | default:p.slug }}
                </a>
            </li>
            {% endfor %}
        </ul>
        {% elif feed.posts %}
        <ul class="feed-nav-list">
            {% for p in feed.posts %}
            <li class="feed-nav-item{% if post.slug == p.slug %} feed-nav-item--active{% endif %}">
                <a href="{{ p.href }}" class="feed-nav-link">
                    {{ p.title | default:p.slug }}
                </a>
            </li>
            {% endfor %}
        </ul>
        {% elif posts %}
        <ul class="feed-nav-list">
            {% for p in posts %}
            <li class="feed-nav-item{% if post.slug == p.slug %} feed-nav-item--active{% endif %}">
                <a href="{{ p.href }}" class="feed-nav-link">
                    {{ p.title | default:p.slug }}
                </a>
            </li>
            {% endfor %}
        </ul>
        {% endif %}
    </nav>
</aside>
{% endif %}
{% endwith %}
